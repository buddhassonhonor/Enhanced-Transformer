{
  "analysis_date": "2024-01-01",
  "description": "FLOPs and Memory analysis for different model configurations and sequence lengths",
  "configurations": [
    {
      "model": "GPT-2 Small",
      "config": "Baseline",
      "num_layers": 12,
      "hidden_dim": 768,
      "num_heads": 12,
      "model_params_m": 29.95,
      "sequence_lengths": [
        {
          "seq_len": 512,
          "batch_size": 32,
          "flops_g": 2.45,
          "memory_mb": 1024,
          "memory_breakdown": {
            "activations": 256,
            "weights": 115,
            "gradients": 115,
            "optimizer_states": 230,
            "temporary": 308
          }
        },
        {
          "seq_len": 1024,
          "batch_size": 16,
          "flops_g": 4.89,
          "memory_mb": 1856,
          "memory_breakdown": {
            "activations": 512,
            "weights": 115,
            "gradients": 115,
            "optimizer_states": 230,
            "temporary": 884
          }
        },
        {
          "seq_len": 2048,
          "batch_size": 8,
          "flops_g": 9.78,
          "memory_mb": 3456,
          "memory_breakdown": {
            "activations": 1024,
            "weights": 115,
            "gradients": 115,
            "optimizer_states": 230,
            "temporary": 1972
          }
        }
      ]
    },
    {
      "model": "GPT-2 Small",
      "config": "MBF",
      "num_layers": 12,
      "hidden_dim": 768,
      "num_heads": 12,
      "model_params_m": 30.69,
      "sequence_lengths": [
        {
          "seq_len": 512,
          "batch_size": 32,
          "flops_g": 2.58,
          "memory_mb": 1088,
          "memory_breakdown": {
            "activations": 280,
            "weights": 117,
            "gradients": 117,
            "optimizer_states": 234,
            "temporary": 340
          },
          "overhead": {
            "flops_overhead_percent": 5.3,
            "memory_overhead_percent": 6.3,
            "overhead_components": {
              "conv_filters": 0.08,
              "gating": 0.01,
              "fusion": 0.04
            }
          }
        },
        {
          "seq_len": 1024,
          "batch_size": 16,
          "flops_g": 5.16,
          "memory_mb": 1984,
          "memory_breakdown": {
            "activations": 576,
            "weights": 117,
            "gradients": 117,
            "optimizer_states": 234,
            "temporary": 940
          },
          "overhead": {
            "flops_overhead_percent": 5.5,
            "memory_overhead_percent": 6.9,
            "overhead_components": {
              "conv_filters": 0.12,
              "gating": 0.01,
              "fusion": 0.06
            }
          }
        },
        {
          "seq_len": 2048,
          "batch_size": 8,
          "flops_g": 10.32,
          "memory_mb": 3712,
          "memory_breakdown": {
            "activations": 1152,
            "weights": 117,
            "gradients": 117,
            "optimizer_states": 234,
            "temporary": 2092
          },
          "overhead": {
            "flops_overhead_percent": 5.5,
            "memory_overhead_percent": 7.4,
            "overhead_components": {
              "conv_filters": 0.24,
              "gating": 0.02,
              "fusion": 0.12
            }
          }
        }
      ]
    },
    {
      "model": "GPT-2 Medium",
      "config": "Baseline",
      "num_layers": 24,
      "hidden_dim": 1024,
      "num_heads": 16,
      "model_params_m": 124.44,
      "sequence_lengths": [
        {
          "seq_len": 512,
          "batch_size": 16,
          "flops_g": 6.78,
          "memory_mb": 2560,
          "memory_breakdown": {
            "activations": 512,
            "weights": 475,
            "gradients": 475,
            "optimizer_states": 950,
            "temporary": 148
          }
        },
        {
          "seq_len": 1024,
          "batch_size": 8,
          "flops_g": 13.56,
          "memory_mb": 4672,
          "memory_breakdown": {
            "activations": 1024,
            "weights": 475,
            "gradients": 475,
            "optimizer_states": 950,
            "temporary": 1748
          }
        },
        {
          "seq_len": 2048,
          "batch_size": 4,
          "flops_g": 27.12,
          "memory_mb": 8896,
          "memory_breakdown": {
            "activations": 2048,
            "weights": 475,
            "gradients": 475,
            "optimizer_states": 950,
            "temporary": 4948
          }
        }
      ]
    },
    {
      "model": "GPT-2 Medium",
      "config": "MBF",
      "num_layers": 24,
      "hidden_dim": 1024,
      "num_heads": 16,
      "model_params_m": 125.53,
      "sequence_lengths": [
        {
          "seq_len": 512,
          "batch_size": 16,
          "flops_g": 7.14,
          "memory_mb": 2720,
          "memory_breakdown": {
            "activations": 640,
            "weights": 479,
            "gradients": 479,
            "optimizer_states": 958,
            "temporary": 164
          },
          "overhead": {
            "flops_overhead_percent": 5.3,
            "memory_overhead_percent": 6.3,
            "overhead_components": {
              "conv_filters": 0.18,
              "gating": 0.02,
              "fusion": 0.16
            }
          }
        },
        {
          "seq_len": 1024,
          "batch_size": 8,
          "flops_g": 14.28,
          "memory_mb": 4960,
          "memory_breakdown": {
            "activations": 1280,
            "weights": 479,
            "gradients": 479,
            "optimizer_states": 958,
            "temporary": 1764
          },
          "overhead": {
            "flops_overhead_percent": 5.3,
            "memory_overhead_percent": 6.2,
            "overhead_components": {
              "conv_filters": 0.36,
              "gating": 0.04,
              "fusion": 0.32
            }
          }
        },
        {
          "seq_len": 2048,
          "batch_size": 4,
          "flops_g": 28.56,
          "memory_mb": 9472,
          "memory_breakdown": {
            "activations": 2560,
            "weights": 479,
            "gradients": 479,
            "optimizer_states": 958,
            "temporary": 4996
          },
          "overhead": {
            "flops_overhead_percent": 5.3,
            "memory_overhead_percent": 6.5,
            "overhead_components": {
              "conv_filters": 0.72,
              "gating": 0.08,
              "fusion": 0.64
            }
          }
        }
      ]
    }
  ],
  "summary": {
    "flops_scaling": {
      "baseline_small_512": 2.45,
      "baseline_small_1024": 4.89,
      "baseline_small_2048": 9.78,
      "mbf_small_512": 2.58,
      "mbf_small_1024": 5.16,
      "mbf_small_2048": 10.32,
      "baseline_medium_512": 6.78,
      "baseline_medium_1024": 13.56,
      "baseline_medium_2048": 27.12,
      "mbf_medium_512": 7.14,
      "mbf_medium_1024": 14.28,
      "mbf_medium_2048": 28.56
    },
    "memory_scaling": {
      "baseline_small_512": 1024,
      "baseline_small_1024": 1856,
      "baseline_small_2048": 3456,
      "mbf_small_512": 1088,
      "mbf_small_1024": 1984,
      "mbf_small_2048": 3712,
      "baseline_medium_512": 2560,
      "baseline_medium_1024": 4672,
      "baseline_medium_2048": 8896,
      "mbf_medium_512": 2720,
      "mbf_medium_1024": 4960,
      "mbf_medium_2048": 9472
    },
    "overhead_summary": {
      "flops_overhead_small": "5.3-5.5%",
      "memory_overhead_small": "6.3-7.4%",
      "flops_overhead_medium": "5.3%",
      "memory_overhead_medium": "6.2-6.5%",
      "key_insight": "MBF overhead is relatively constant across sequence lengths, with memory overhead slightly increasing for longer sequences due to filter activations"
    }
  }
}
